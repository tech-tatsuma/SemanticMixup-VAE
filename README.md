# SemanticMixup-VAE
## 概要
SemanticMixup-VAEは、VAE（変分オートエンコーダ）とSinkhorn距離に基づく特徴アライメントを活用し、**二つの画像の意味を保ったまま合成する”セマンティックMixup画像”**を生成するPyTorch実装です。
本プロジェクトでは、CelebAデータセットを使って性別ラベルをもとに、ラベルの異なる2枚の顔画像から、意味的に滑らかに混ざり合った新しい顔画像を生成します。

---
## 特徴
- 特徴空間における意味的Mixupの実現
- Sinkhorn距離に基づいた特徴整列(AlignMixup)による高品質な合成
- オリジナル・Mixup再構成の両方に対するVAE学習
- 性別ラベルを使ったラベル整合性Mixup

---
## セットアップ
1. 依存ライブラリのインストール
```sh
pip install torch torchvision matplotlib tqdm
```

---
## 学習方法
```sh
python recon_train.py
```
- 学習ではオリジナル画像とMixup画像両方を再構成できるようにVAEを訓練します．
- `val_outputs/` に再構成された画像が毎エポック保存されます．
- 最良のモデル(best_model.pth)が保存されます．

---
## コア技術
### Sinkhorn距離による特徴整列
潜在特徴マップ間の対応関係を計算することで，意味的に整合した特徴同士のMixupが可能になります．

### VAEによる再構成
- エンコーダで潜在空間へ変換
- アライメントされた後にMixupされた特徴をデコーダで画像へ復元

---
## 応用例
- データ拡張: セマンティックMixupは教師あり学習の汎化性能を向上させる可能性があります．
- 画像生成: 既存画像をもとに意味的に滑らかな変換系列を生成可能．
- スタイル混合: 異なるカテゴリの属性を組み合わせた新たなデータ生成．